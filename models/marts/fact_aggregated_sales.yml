version: 2

models:
  - name: aggregated_sales
    description: |
      This model aggregates sales data by salesperson, location, and date.
    columns:
      - name: salespersonid
        description: The ID of the salesperson.
        tests:
          - unique
      - name: firstname
        description: The first name of the salesperson.
      - name: lastname
        description: The last name of the salesperson.
      - name: cityname
        description: The name of the city where the sales were made.
      - name: statename
        description: The name of the state where the sales were made.
      - name: countryname
        description: The name of the country where the sales were made.
      - name: totalsales
        description: The total sales amount.
        tests:
          - not_null
      - name: totalorders
        description: The total number of orders.
        tests:
          - not_null
      - name: orderdate
        description: The date of the order.
        tests:
          - not_null
      - name: converted_orderdate
        description: The order date converted to a timestamp.
        tests:
          - not_null
    materialized: table
    schema: aggregated_tables
    unique_key: [salespersonid, orderdate, cityname, statename, countryname]
    sql: models/marts/fact_aggregate_sales.sql
